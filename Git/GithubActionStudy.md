Github Actions란 무엇인가?
Workflows란?
Jobs란?
Steps란?
Actions란?
with

워크플로우 파일 작성 방법
name
on
runs-on
steps

Actions 시나리오 탐색
checkout
cache

Jobs 심화
작업 실행 순서 제어
작업 간 output 전달
선택적 작업 실행

그 외(추가 가능)
참고 자료: https://docs.github.com/ko/actions

---

# GitHub Actions 이해

## 개요

---

GitHub Actions는 빌드, 테스트 및 배포 파이프라인을 자동화할 수 있는 CI/CD(연속 통합 및 지속적인 업데이트) 플랫폼임. 리포지토리에 대한 모든 Pull 요청을 빌드 및 테스트하거나 병합된 Pull Request 를 프로덕션에 배포하는 워크플로를 만들 수 있음.

GitHub Actions은(는) 단순한 DevOps 수준을 넘어 리포지토리에서 다른 이벤트가 발생할 때 워크플로를 실행할 수 있도록 함. 예를 들어 누군가가 리포지토리에서 새 이슈를 만들 때마다 워크플로를 실행하여 적절한 레이블을 자동으로 추가할 수 있음.

## Workflow

---

*Workflow* 는 하나 이상의 작업을 실행할 구성 가능한 자동화된 프로세스임. 워크플로는 리포지토리에 체크인된 YAML 파일에서 정의되며, 리포지토리의 이벤트로 트리거될 때 실행되거나 수동으로 또는 정의된 일정에 따라 트리거될 수 있음.

*Workflow*는 리포지토리의 .github/workflows 디렉터리에 정의됨. 리포지토리에 다음과 같은 각각의 다른 작업 집합을 수행하는 여러 워크플로가 있을 수 있음.

- Pull Request를 빌드하고 테스트함.
- 릴리스가 생성될 떄마다 애플리케이션을 배포함.
- 새 문제가 보고될 때마다 레이블을 추가함.

다른 워크플로 내에서 워크플로를 참조할 수 있음.

## Jobs

---

*Jobs*란 독립된 가상 머신(machine) 또는 컨테이너 (container)에서 돌아가는 하나의 처리 단위를 의미합니다. 하나의 워크플로우는 여러 개의 작업으로 구성되며 적어도 하나의 작업은 있어야 함. (아니라면 실행할 작업이 없으니 워크플로우가 의미가 없어짐) 모든 작업은 기본적으로 동시에 실행되며 필요 시 작업 간에 의존 관계를 설정하여 작업이 실행되는 순서를 제어할 수도 있음.

작업은 워크플로우 YAML 파일 내에서 *jobs* 속성을 사용하며 작업 식별자(ID)와 작업 세부 내용 간의 맵핑(Mapping) 형태로 명시가 됨.

***.github/workflows/example.yml
```
# ...(생략)...

jobs:
    job1:
        # job1에 대한 세부 내용
        runs-on: ubuntu-latest
    job2:
        # job2에 대한 세부 내용
    job3:
        # job3에 대한 세부 내용
```
예를 들어, 가장 널리 사용되는 우분투의 최신 실행 환경에서 해당 작업을 실행하고 싶다면 다음과 같이 설정합니다.

## Steps

---

정말 단순한 작업이 아닌 이상 하나의 작업은 일반적으로 여러 단계의 명령을 순차적으로 실행하는 경우가 많음. 
-> Github Actions 에서는 각 작업 (job)이 하나 이상의 단계(step)로 모델링이 됨.

작업 단계는 단순한 커맨드(command)나 스크립트(script)가 될 수도 있고 다음 섹션에서 자세히 설명할 액션(action)이라고 하는 좀 더 복잡한 명령일 수도 있음.
커맨드나 스크립트를 실행할 때는 ~run~ 속성을 사용하며, 액션을 사용할 때는 ~uses~ 속성을 사용함.

예를 들어, 자바스크립트 프로젝트에서 테스트를 돌리려면 코드 저장소에 코드를 작업 실행 환경을 내려 받고, 패키지를 설치한 후, 테스트 스크립트를 실행해야 함.
이 3단계의 작업을 ~steps~ 속성을 통해 명시.

```
# ...(생략)...

jobs:
    test:
        runs-on: ubuntu-latest
        steps:
            - uses: actioins/checkout@v3
            - runs: npm install
            - runs: npm test
```

## Actions

---

~Actions~은 Github Actions에서 빈번하게 필요한 반복 단계를 재사용하기 용이하도록 제공되는 일종의 작업 공유 메커니즘임. 이 액션은 하나의 코드 저장소 범위 내에서 여러 워크플로우 간에서 공유를 할 수 있을 뿐만 아니라, 공개 코드 저장소를 통해 액션을 공유하면 Github 상의 모든 코드 저장소에서 사용이 가능해짐.

Github에서 제공하는 대표적인 공개 액션으로 바로 위 예제에서도 사용했던 체크 아웃 액션(actions/checkout) 을 들 수 있음. 대부분의 CI/CD 작업은 코드 저장소로 부터 코드를 작업 실행 환경으로 내려받는 것으로 시작되므로 이 액션이 얼마나 범용적으로 사용될지는 굳이 말할 필요가 없음.

뿐만 아니라 Github Marketplace에서는 수많은 벤더(vendor)가 공개해놓은 다양한 액션을 쉽게 접할 수 가 있음. 이 액션을 중심으로 하나의 큰 커뮤니티가 형성되고 더 많은 사용자와 벤더가 Github Actions로 몰려드는 선순환이 발생.


