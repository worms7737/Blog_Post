# Network

## Network Layer

- 여러 노드의 경로를 찾고 올바르게 전달 될 수 있는 기능과 수단을 정의
- 주요 단위: 패킷
- 주요 구성 요소
    - ** Route, IP, ARP **
- 주요 특징
    - 서로 떨어진 Local Network 간의 통신을 지원
    - "Network 간의" -> Inter Network -> Internet
    - 중간중간 Node들을 거쳐서 목적지 까지 도달할 수 있는 방법을 지원

---

## IP(internet protocol) Address

- internet protocol상에서 통신 주체를 식별하기 위한 아이디
- 두가지 종류
    - IPv4 : 32Bits (2^32 = 약 43억개)
        - 아이피를 최대로 활용하기 위해 사설(private) ip 와 공인(public) ip 로 분류
    - IPv6 : 128Bits (2^128)
        - IPv4 보다 훨~씬 더 많음
        - 따라서 사설ip 개념 불필요
    MAC Address와 다르게 수시로 변동 가능

---

### Classless Inter Domain Routing(CIDR)

- IP는 주소의 영역을 여러 네트워크 영역으로 나누기 위해 IP를 묶는 방식
- 여러 개의 사설망을 구축하기 위해 망을 나누는 방법

### CIDR Notation

- IP 주소의 **집합**
- 네트워크 주소와 호스트 주소로 구성
- 각 호스트 주소 숫자 만큼의 아이피를 가진 네트워크 망 형성 가능
- A.B.C.D/E 형식
    - 예: 10.0.1.0/24 , 172.16.0.0/12
    - A,B,C,D : 네트워크 주소 + 호스트 주소 표시
    - E : 0~32, 네트워크 주소가 몇 bit 인지 표시

---

### CIDR Block

- 호스트 주소 비트만큼 IP 주소를 보유 가능
- 예: 192.168.2.0/24
    - 네트워크 비트 24
    - 호스트 주소 = 32-24=8
    - 즉 2^8 = 256개의 IP 주소 보유
    - 192.168.2.0~192.168.2.255까지 총 256개 주소를 의미

---

### Subnet Mask

- 어느 부분이 호스트 비트이지, 어느 부분이 네트워크 비트인지 구분해주는 Mask
    - AND 연산을 활용해 네트워크 주소를 필터링
    - AND 연산: 두 비트중 둘다 1일때만 1
        예: 1 and 1 = 1, 0 and 1 = 0, 1 and 0 = 0
    - 네트워크 비트 수만큼 1을 보유한 마스크를 IP에 적용하면 네트워크 비트만 추출 가능

---

### 라우터 (Router)

- 네트워크간에 패킷을 주고 받는 Layer3 장치
- IP 대역별 최적 경로를 수집 및 관리
    - 어떤 경로의 노드를 경유해야 가장 효율적으로 대상에 도착하는지 알고 있음 (Route Table)
    - 이 경로를 바탕으로 특정 IP 주소가 대상인 패킷의 전달을 요청받을 때 해당 경로로 요청
- 로컬 네트워크는 자신의 로컬 네트워크 주소가 아니라면 라우터로 전달
    - 확인 방법: 네트워크 주소가 같은지 확인(subnet mask 등)
- 이후 Router는 패킷을 Frame 안에 넣어서 최적 경로에 따른 다른 Router로 전달

---

### ARP(Address Resolution Protocol)

- IP로 Mac 어드레스를 찾는 프로토콜
- 순서
    - Broadcast (MAC Address FF:FF:FF:FF:FF) 로 IP 요청
    - 응답 받은 IP MAC Address를 기반으로 MAC 확정 후 테이블에 저장

---

## 전체 일련의 과정 연결하기

1. 라우터까지 데이터 전달하기
    - IP 대상(네트워크 주소 확인)이 로컬이 아닌 것 식별
    - 같은 네트워크가 아니라면 라우터로 전달
        - 하지만 라우터의 IP는 알지만 MAC 주소를 모름
    - ARP 활용
        - IP <-> MAC 어드레스를 찾는 프로토콜
    - 이후 해당 MAC Address로 Frame 생성 후 전달

2. 정리 필요